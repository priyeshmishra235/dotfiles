# ========================================
# Terminal and General Settings
# ========================================
set-option -sa terminal-overrides ",xterm*:Tc"
set -g mouse on

# ========================================
# Prefix Key Configuration
# ========================================
unbind C-b
set -g prefix M-s
bind M-s send-prefix

# ========================================
# Window and Pane Indexing
# ========================================
set -g base-index 1
set -g pane-base-index 1
set-window-option -g pane-base-index 1
set-option -g renumber-windows on

# ========================================
# Plugins and TPM Initialization
# ========================================
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'christoomey/vim-tmux-navigator'
set -g @plugin 'tmux-plugins/tmux-yank'

# ========================================
# Minimal Dark Status Line
# ========================================
set -g status on
set -g status-interval 2
set -g status-justify left

# Background and Foreground Colors
set -g status-bg colour234
set -g status-fg colour248

# Status Line Lengths
set -g status-left-length 100
set -g status-right-length 60

# Left Side — Window List
setw -g window-status-format " #[fg=colour240]#I #[fg=colour250]#W "
setw -g window-status-current-format " #[bg=colour250,fg=colour232,bold] #I:#W #[default]"
setw -g window-status-separator "│"
set -g status-left "#[fg=colour247]"

# Right Side — Time and Date Display
set -g status-right "#[fg=colour39,bold]%H:%M #[fg=colour240]| #[fg=colour250]%Y-%m-%d "

# Pane Borders (Clear Separation)
set -g pane-border-style fg=colour237
set -g pane-active-border-style fg=colour39

# Message Styling (Reload, Prompts, etc.)
set -g message-style bg=black,fg=white
set -g message-command-style bg=black,fg=white

# ========================================
# Custom Window Management Keymaps
# ========================================

# Unbind default window bindings
unbind c          # Default: Create new window
unbind ,          # Default: Rename window
unbind &          # Default: Close current window
unbind w          # Default: List windows
unbind p          # Default: Previous window
unbind n          # Default: Next window

bind-key -n M-a new-window -c "#{pane_current_path}"

# Rename current window (Alt + r)
bind-key -n M-r command-prompt -I "#W" "rename-window '%%'"

# Close current window (Alt + x)
bind-key -n M-x confirm-before -p "Kill window #W? (y/n)" kill-window

# List all windows (Alt + w)
bind-key -n M-w list-windows

# Previous and next windows
bind -n M-\; previous-window
bind -n M-\' next-window

# Panes default unbind
unbind !
unbind '{'
unbind '}'
unbind '"'
unbind '%'
unbind Space
unbind q
unbind o
unbind z
unbind C-o
unbind C-Up
unbind C-Down
unbind C-Left
unbind C-Right
unbind Up
unbind Down
unbind Left
unbind Right
unbind l
unbind j
unbind k
unbind h

# Toggle last active pane
# bind -n M-` last-pane

# Split panes
# bind -n M-h split-window -h -c "#{pane_current_path}"
# bind -n M-v split-window -v -c "#{pane_current_path}"

# Join panes / move panes between windows
# bind -n M-J command-prompt -p "join-pane -s" "join-pane -s '%%'"
# bind -n M-M command-prompt -p "move-pane (join-pane -s window.pane -t target)" "join-pane -s '%%'"

# Move panes around (swap)
# bind -n M-Left  swap-pane -L
# bind -n M-Right swap-pane -R
# bind -n M-Up    swap-pane -U
# bind -n M-Down  swap-pane -D

# Navigate panes
# bind -n M-h select-pane -L
# bind -n M-j select-pane -D
# bind -n M-k select-pane -U
# bind -n M-l select-pane -R

# Toggle synchronize panes
# bind -n M-s setw synchronize-panes

# Cycle pane layouts
# bind -n M-Space next-layout

# ========================================
# Vi Mode for Copy Mode
# ========================================
set-window-option -g mode-keys vi
bind-key -T copy-mode-vi v   send-keys -X begin-selection
bind-key -T copy-mode-vi C-v send-keys -X rectangle-toggle
bind-key -T copy-mode-vi y   send-keys -X copy-selection-and-cancel


# ========================================
# Pane Splitting with Current Path
# ========================================
bind -n M-f split-window -v -c "#{pane_current_path}"
bind -n M-v split-window -h -c "#{pane_current_path}"


# ========================================
# Configuration Reload Keybinding
# ========================================
bind r source-file ~/.config/tmux/tmux.conf \; display-message "Tmux config reloaded!"

# Initialize TPM (Tmux Plugin Manager)
run '~/.tmux/plugins/tpm/tpm'
